require(ggplot2)

# load training_set
data <- read.csv("/home/john86/Kaggle/Titanic/Data/training_set.csv")

attach(data)


# examine missinginess
table(survived)
table(pclass)



























































































































































































































































































































































































































































































































































p <- ggplot(data=data,aes(x=as.factor(survived),y=age))
p + geom_boxplot(aes(fill=sex)) +facet_grid(embarked~pclass)


# Plot sex survival by fare #
f<-function(g,p){
  probs <- numeric(0)
  for(i in 1:length(p)){
    probs[i]<-
      table(survived[fare>=p[i]&sex==g])[[2]]/
      (table(survived[fare>=p[i]&sex==g])[[1]]+table(survived[fare>=p[i]&sex==g])[[2]])
  }
  return(probs)
}

fares <- seq(from=0,to=175,by=1)
fares2 <- seq(from=0,to=150,by=1)

plot(fares[pclass==1],f("male",fares)[pclass==1],col="blue",pch=1)
points(fares[pclass==2],f("male",fares)[pclass==2],col="red",pch=1)
points(fares[pclass==3],f("male",fares)[pclass==3],col="black",pch=1)

plot(fares2[pclass==1],f("female",fares2)[pclass==1],col="blue",pch=1)
points(fares2[pclass==2],f("female",fares2)[pclass==2],col="red",pch=1)
points(fares2[pclass==3],f("female",fares2)[pclass==3],col="black",pch=1)

fares_sq <- fares**2
fares2_sq <- fares2**2
try_this_fit_male <- lm(f("male",fares)~fares+fares_sq)
summary(try_this_fit_male)
try_this_fit_female <-lm(f("female",fares2)~fares2+fares2_sq)
summary(try_this_fit_female)


fare_class <- ggplot(train,aes(x=as.factor(pclass),y=fare))
fare_class + geom_boxplot()

ftable(table(sex,cabin_listed,survived,pclass))

#Look at cabin number
cabin_number_plot <- ggplot(train,aes(x=cabin_number,y=survived))+geom_point()
cabin_number_plot + geom_line()
